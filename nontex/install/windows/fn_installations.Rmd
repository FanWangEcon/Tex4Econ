---
title: "New Computer Data-Science Set-up: Python (anaconda, pycharm), R (r-studio) and other Programs Installations"
output:
  pdf_document:
    df_print: paged
    number_sections: true
  html_notebook:
    number_sections: true
  word_document:
    number_sections: true
  html_document:
    number_sections: true
urlcolor: blue
always_allow_html: yes
---

Go back to [fan](http://fanwangecon.github.io/)'s [Tex4Econ and Miscellaneous Repository](http://fanwangecon.github.io/Tex4Econ/).

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, eval = FALSE)
```

# Objective

For the following types of programming tasks, install relevant programs, that are cross platform compatible. Test at the end that example programs work.

1. Python
    + Anaconda Dist
    + Pycharm
    + atom hydrogen
2. R
    + R
    + Rstudio
    + atom hydrogen
3. Matlab
    + Matlab
4. Latex and PDF
    + atom latex
    + texstudio
    + texlive
    + okular pdf

Test at the end:

1. Do sample *py* files work?
    + work from command line?
    + work from atom (hydrogen)
2. Do sample *rmd* files work?
    + work from r-studio
    + work from atom (hydrogen), r file
3. Do tex templates compile?
    + tikz files
    + template files with bib

# Conda

Use conda across platforms, so that locally on windows and ubuntu and remotely on aws, can have the same software setup environment.

Search for Anaconda Prompt, right click, choose run as administrator.

Check software versions.


```{bash}
conda list anaconda
python -V
```

## First Time Conda Install

Download and install for all users. Afterwards, Anaconda does not automatically get added to Windows Path. Need to use Anaconda Prompt to access programs. To access Anaconda packages from windows prompt, from git bash, from R, etc, need to Add Anaconda to Windows Path

See Anaconda Installation Directory, in anaconda prompt:

```{bash}
where anaconda
# C:/ProgramData/Anaconda3/Scripts/anaconda.exe
where python
# C:/ProgramData/Anaconda3/python.exe
where jupyter
# C:/ProgramData/Anaconda3/Scripts/jupyter.exe
where jupyter-kernelspec
# if R installed already
where r

###############################
# Add these to Windows PATH:
###############################
# C:/ProgramData/Anaconda3/Scripts
# C:/ProgramData/Anaconda3
```

To Add Anaconda to Path, In Windows
1. search for: Environment Variables
2. Edit Environment Variables
3. Add new to Path (lower half):
    - C:/ProgramData/Anaconda3/Scripts/
    - C:/ProgramData/Anaconda3/
4. Now open up regular windows command Prompt, Type in:
    - conda --version
    - also Close and Open up Git Bash: conda --version

## Conda Update

Open up Anaconda Navigator, it will update navigator automatically. If there are errors, might have to clean first.

```{bash}
# # if there are bugs
# conda clean --packages
# use conda-forge as main channel, more updated packages
conda config --get channels
conda config --add channels conda-forge
conda config --get channels
# remove conda-forge from channels (do so for main env install)
conda config --remove channels conda-forge
# normal update
conda update --all
```

## Conda Test Python

Fist test python under command line:

```{r}
# windows
python "C:/Users/fan/PyFan/ProjectSupport/Testing/Numpy/Functions.py"
python "C:/Users/fan/PyFan/ProjectSupport/graph/subplot.py"
# linux
python ~/PyFan/ProjectSupport/Testing/Numpy/Functions.py
python ~/PyFan/ProjectSupport/graph/subplot.py
```

## Jupyter and Atom Hydrogen

For both Jupyter as well as Atom, always open from command prompt, open from *Anaconda Prompt* with admin rights.

First, open up *Jupyter Notebook*, does the python kernel work? If does not, uninstall and re-install Anaconda.

```{bash}
# start jupyter lab, from prompt
jupyter lab
```

Now test python within atom:

1. install hydrogen in atom. Follow [instructions](http://nteract.io/atom).
    - terminal in windows or linux after installation: *apm install hydrogen*
    - apm is the atom package manager.
2. go to the programs above and try to run.

```{bash}
# Once atom is installed, can use apm to install packages
apm install hydrogen
# Inside Conda open up atom
atom
# open up any py from from within, try 1+1, does it work?
```

## Additional Packages

```{r}
conda install statsmodels datashape seaborn
# conda install statsmodels
# conda install datashape
# conda install seaborn

conda install -c conda-forge interpolation awscli
# conda install -c conda-forge interpolation
# conda install -c conda-forge awscli

conda install -c anaconda boto3

# conda install -c r r-irkernel
```

# R Installation

Try to install R from within Conda. The procedure here is the same for windows as well as linux machines.

## Fully uninstall r

open up RStudio, and see where paths are.
also open up R from command prompt, see where paths are.

```{R}
.libPath()
```

Open up install and uninstall programs, find R and Rstudio, and uninstall them. Then delete all files found path paths shown by *.libPath()*, looking at these:
    - *C:/Users/fan/Documents/R/win-library/3.6*
    - *C:/Program Files/R/R-3.6.1/library*

## Install R (outside of Conda)

1. [download R](https://cloud.r-project.org/)
    + for debian: [Johannes Ranke](https://cran.r-project.org/bin/linux/debian/)
2. [download R-studio](https://rstudio.com/products/rstudio/download/)
3. Open R-studio and auto-detect R
4. Install packages

note that installation will not work if the machine's version of R is not up to date, this could be the case with default R versions for some linux installations. For Debian for example, need to update the *source.list* to include sources that have more recent versions of R.

Additionally, need to install *libcurl4-openssl-dev* and *libssl-dev* from command prompt first inside Debian.

```{bash}
# Go to get latesdebian latest r sources.list
cat /etc/apt/sources.list
# Install this First (should already be installed)
sudo apt install dirmngr

# Debian R is maintained by Johannes Ranke, copied from https://cran.r-project.org/bin/linux/debian/:
apt-key adv --keyserver keys.gnupg.net --recv-key 'E19F5F87128899B192B1A2C2AD5F960A256A04AF'
# Add to source.list, for debian stretch (9)
# sudo su added for security issue as super-user
sudo su -c "sudo echo 'deb http://cloud.r-project.org/bin/linux/debian stretch-cran35/' >> /etc/apt/sources.list"
# if added wrong lines, delete 3rd line
sudo sed '3d' /etc/apt/sources.list

# Update and Install R, should say updated from cloud.r
sudo apt-get update
sudo apt-get install r-base r-base-dev

# Also install these, otherwise r-packages do not install:
sudo apt-get install libcurl4-openssl-dev
sudo apt-get install libssl-dev
```

```{r}
# Install R-tools, RTOOLS is for WINDOWS
install.packages("installr")
library("installr")
install.Rtools()
# c:/Rtools/bin;
# c:/Rtools/mingw_32/bin;
# c:/Rtools/mingw_64/bin;

# main packagevps
# tidymodel installation on linux difficult
install.packages(c("tidyr", "tidyverse", "tidymodels"))
# development packages
install.packages(c("devtools", "irkernel", "pkgdown", "roxygen2"))
# other packages
install.packages(c("AER", "minpack.lm", "knitr", "kableExtra", "matlab"))

# Install my package
devtools::install_github("fanwangecon/R4Econ")

# Kernel
install.packages(c('repr', 'IRdisplay', 'evaluate', 'crayon', 'pbdZMQ', 'devtools', 'uuid', 'digest'))
devtools::install_github('IRkernel/IRkernel')
IRkernel::installspec()
```

## Set up R-Environment in Conda

Conda environments are language agnostic. pip is a package manager for Python. venv is an environment manager for Python. conda is both a package and environment manager and is language agnostic. Inside Anaconda Prompt:

Key packages are generally available in conda's default channel (official distribution) and also the more frequently updated conda-forge channel. Prioritize conda-forge to get the latest packages. after adding *conda-forge* to channels, that will be prioritized, so when creating a new environment, conda will install first from conda-forge if package exists there. Try the *r_env* generation line with and without first adding *conda-forge* to channel, and see that the packages installed will have different versions, reflecting versions in the default channel and in the *conda-forge* channels.

```{bash}
# Set up Channel, for R, to get latest r-packages
# do not set-up channels to prioritize conda-forge for main env.
conda config --add channels conda-forge
# install key r packages within a r-environment
conda env remove -n r_env
conda create -n r_env r-essentials r-base r-tidyr r-tidyverse r-devtools r-irkernel r-pkgdown r-roxygen2
# see all installed environments
conda env list
# activate an environment to use it, if in base, r does not exist, isolated in r_env
conda activate r_env
# see packages in environment
conda list
# to quit
conda deactivate
```

- **Location**: Installed environments are shown appear in the *envs* folder of *C:/ProgramData/Anaconda3/envs/*. Can be easily deleted without disrupting the main base installation for conda. This is very important. During installation, could easily run into problems, and need to re-install. Much better to only re-install a folder. Note that when R is installed in *envs*, it will not show up under add or remove programs for uninstallation from there, has to be uninstalled, deleted directly here.
- **Use only in Env**: Note that if we installed r inside r_env, if we type *r* under the base environment, we can not enter r. We can only enter r within r_env. With PATH properly set-up, this happens under Conda Prompt, Windows Prompt, etc.
- **Multiple Pythons**: With the above installation for R, one benefit is that if R requires a different version of Python than what the base environment uses, the r_env could have a different python version. So type *python* in the base environment as well as inside the *r_env*. This also means potentially there could be duplicated installations I think. Look at the python versions under *conda list* in the base and in the r-environment.
- **File Size**: Note that this creates a large installation folder, *C:/ProgramData/Anaconda3/envs/r_env/*, without additional packages, is 1.3 GB in size

## Install Additional Packages inside the R-environment

These are packages that I use, these should be installed inside the environment. Or they could be installed later from inside r-studio. Installing inside r-studio is a lot better.

This did not work in windows, *tidymodels* failed to install. Perhaps because of directory issues. *tidymodels* required *rstanarm*, and *rstanarm* failed to install.

```{bash}
### One line
conda install -c conda-forge r-aer r-minpack.lm r-knitr r-kableExtra r-matlab
# conda install -c conda-forge r-rstanarm

#######################################
### Estimation
#######################################
# Estimation Tools
# tidymodels does not work fron conda install
# Linear Regression Package
# https://anaconda.org/conda-forge/r-aer
# Nonlinear Regression Package
# https://anaconda.org/conda-forge/r-minpack.lm
conda install -c conda-forge r-aer r-minpack.lm
# enter r and use devtools
# install.packages("tidymodels")

#######################################
### Visualiation
#######################################
conda install -c conda-forge r-knitr r-kableExtra

#######################################
### Utilities
#######################################
# Allowing for Invoking Matlab Files from Inside R
conda install -c conda-forge r-matlab
```

Install additional packages from inside R. The devtools install will install packages inside *envs/r_env/Lib/R*.

```{r}
#######################################
### Own Package
#######################################
devtools::install_github("fanwangecon/R4Econ")
# install_dev("cli")
```

## R-Studio Set-up Download from Rstudio

1. Download R-studio, and install, as normal (not from conda, directly from rstudio website latest windows version)
2. Open up anaconda prompt, enter *r_env* environment: *activate r_env*
3. cd into rstudio exe file folder: cd "C:/Program Files/RStudio/bin"
4. start r-studio from inside *r_env*: rstudio.exe
5. inside r-studio, check: *.libPaths()*
    - "C:/ProgramData/Anaconda3/envs/r_env/Lib/R/library"

```{bash}
activate r_env
cd "C:/Program Files/RStudio/bin"
rstudio.exe

cd "C:/ProgramData/Anaconda3/envs/r_env/Lib/R/library"
"C:/Program Files/RStudio/bin/rstudio.exe"
```

For linux, note that rstudio offers Ubuntu as well as Debian versions that can be installed with wget:

```{bash}
<!-- for ubuntu -->
wget "https://download1.rstudio.org/desktop/bionic/amd64/rstudio-1.2.5033-amd64.deb"
<!-- for debian -->
sudo apt install ./rstudio-1.2.5033-amd64.deb
wget "https://download1.rstudio.org/desktop/debian9/x86_64/rstudio-1.2.5033-amd64.deb"
sudo apt install ./rstudio-1.2.5033-amd64.deb
conda install -c r rstudio
cd "C:/Program Files/RStudio/bin"
rstudio.exe

cd "C:/ProgramData/Anaconda3/envs/r_env/Lib/R/library"
"C:/Program Files/RStudio/bin/rstudio.exe"
```

## Install Packages from R-Studio

Install addition files inside Rstudio. Easier to debug potentially. Install rtools as described [here](https://thecoatlessprofessor.com/programming/cpp/installing-rtools-for-compiled-code-via-rcpp/): [rtools download](https://cran.r-project.org/bin/windows/Rtools/). Alternatively:

```{r}
install.packages("installr")
library("installr")
# Note that this will generate several pop-up windows
install.Rtools()
# choose to only install 64 bit toolchain
# this installs g++ which is needed for rstanarm
# Add these below to windows path
# c:/Rtools/bin;
# c:/Rtools/mingw_64/bin;

if (!require(devtools)) {
  install.packages("devtools")
  library(devtools)
}
library(devtools)
install_github("stan-dev/rstanarm", args = "--preclean")

setwd('C:/ProgramData/Anaconda3/envs/r_env/Lib/R/library')

install.packages("stan-dev/rstanarm", dependencies=TRUE, INSTALL_opts = c('--no-lock'))

# other packages
install.packages(c("tidymodels", "AER", "minpack.lm", "knitr", "kableExtra", "matlab"))

# for r-kernel to work in Atom
install.packages(c('repr', 'IRdisplay', 'evaluate', 'crayon', 'pbdZMQ', 'devtools', 'uuid', 'digest'))
devtools::install_github('IRkernel/IRkernel')
IRkernel::installspec()

# Install my package
devtools::install_github("fanwangecon/R4Econ")
```

### Test Files

Test the following file to see if we can execute a R file. Do it inside *r_env* and inside a *r* session.

```{r}
# A simple file with summary statistics using tidyverse
source('C:/Users/fan/R4Econ/summarize/dist/fst_hist_onevar.R')
# Another simple file with summary statistics using tidyverse
source('C:/Users/fan/R4Econ/support/tibble/fs_tib_basics.R')
# A file involving estimation
source('C:/Users/fan/R4Econ/optimization/cesloglin/fst_ces_plan_linlog.R')

# C:/Users/fan/R4Econ/summarize/dist/fst_hist_onevar.Rmd
# C:/Users/fan/R4Econ/support/tibble/fs_tib_basics.Rmd
# C:/Users/fan/R4Econ/optimization/cesloglin/fst_ces_plan_linlog.Rmd
```

# Install Latex

Use a combination of overleaf and local compile. The goal is to have the same installation set-up for windows as well as linux. And hopefully, locally compilable file also can be compiled on overleaf (only use packages also available on overleaf).

There are several pieces of things to install:

1. latex compiler: pdflatex, etc
2. tex distributions: MikTex, texlive
    + these folders, once various packages are installed, could be very large, many GB
3. latex packages from distributions
3. editor (gui): Atom, texStudio, etc

## Uninstall

- uninstall *MiKTeX*: delete from programs, then delete remaining folder in Program Files.
- uninstall *texlive*: go to *c:/texlive*, delete the folder

## Install

*Install on Windows*

- [Install Texstudio](https://www.texstudio.org/)
- [Install texlive](https://www.tug.org/texlive/acquire-netinstall.html)

*Install on Ubuntu*

install texlive and texstudio ubuntu/debian.

```{bash}
sudo apt-get update
sudo apt-get install texlive-full
sudo apt-get install texstudio
```

## Compile in Atom and Texstudio

Install the following two packages in atom:

1. [latex](https://github.com/thomasjo/atom-latex) package on atom.
2. [language-latex](https://atom.io/packages/language-latex) package on atom

In Atom Latex setting, note that on different platforms, paths to texlive are different:

- Path:
    + Windows: *C:/texlive/2019/bin/win32*
    + Chromebook Linux: */usr/bin/latex*
- Which PDF viewer to use:
    + download Okular and use [Okular](https://okular.kde.org/)

```{bash}
# set TeX path
# C:/texlive/2019/bin/win32

# Latex, after installation
# see where texlive appears under root folder directories
sudo find / -name "texlive"
# see latex version, if texlive is used
latex -v
# see main exe directory
which latex
# /usr/bin/latex
```

Go to Tex4Econ and compile various template files and other types of files there to see if tex is working.

Compile the same files in texstudio.

# Other Programs to Install

## Development Programs

- [pycharm](https://www.jetbrains.com/pycharm/)

## Key Programs

**PDF**

- PDF Okular
    + Linux: *sudo apt-get install okular*
    + Windows: install okular from windows app store
- PDF Adobe Acrobat
    + go to adobe website, log in using fwang26@uh.edu
    + go to my account, choose view and download my apps, choose acrobat & PDF, download Acrobat DC
    + UH account can only be activated on two accounts at once, so need to kick other computers out temporarily potentially

**VPN**

- [Proton VPN](https://protonvpn.com/): unlimited usage free version available.


## Utilities

- 7-zip
